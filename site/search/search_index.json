{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"xltemplate","text":"<p>A clean, OOP interface for populating Excel templates with DataFrames.</p>"},{"location":"#what-is-xltemplate","title":"What is xltemplate?","text":"<p><code>xltemplate</code> provides a stateful, object-oriented API for loading Excel templates, writing pandas or polars DataFrames to specific locations, and saving the result\u2014all while preserving existing formatting and formulas.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>DataFrame support \u2014 Works with both pandas and polars</li> <li>Preserves formatting \u2014 Cell styles, fonts, and colors remain intact</li> <li>Preserves formulas \u2014 Existing formulas are not overwritten by default</li> <li>Method chaining \u2014 Fluent API for writing multiple DataFrames</li> <li>Context manager \u2014 Auto-close with <code>with Workbook(...) as wb:</code></li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from xltemplate import Workbook\n\n# Load an existing template\nwith Workbook(\"template.xlsx\") as wb:\n    # Write a DataFrame starting at row 5, column 2\n    wb.sheet(\"Data\").write_df(df, row=5, col=2)\n\n    # Write a single value\n    wb.sheet(\"Summary\").write_value(\"Report Title\", row=1, col=1)\n\n    # Save to a new file\n    wb.save(\"output.xlsx\")\n</code></pre>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install xltemplate\n</code></pre>"},{"location":"#optional-dependencies","title":"Optional Dependencies","text":"<pre><code># pandas support\npip install xltemplate[pandas]\n\n# polars support\npip install xltemplate[polars]\n\n# both\npip install xltemplate[all]\n</code></pre>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Tutorials \u2014 Step-by-step guides</li> <li>API Reference \u2014 Complete documentation</li> </ul>"},{"location":"#links","title":"Links","text":"<ul> <li>GitHub Repository</li> </ul>"},{"location":"reference/api/","title":"API Reference","text":"<p>Complete documentation for xltemplate classes and methods.</p>"},{"location":"reference/api/#workbook","title":"Workbook","text":""},{"location":"reference/api/#xltemplate.Workbook","title":"<code>xltemplate.Workbook</code>","text":"<p>A wrapper around an openpyxl Workbook for template population.</p> <p>Provides a clean, stateful interface for loading Excel templates, writing DataFrames to sheets, and saving the result.</p> Example <p>wb = Workbook(\"template.xlsx\") wb.sheet(\"Data\").write_df(df, row=5, col=2) wb.save(\"output.xlsx\")</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>class Workbook:\n    \"\"\"\n    A wrapper around an openpyxl Workbook for template population.\n\n    Provides a clean, stateful interface for loading Excel templates,\n    writing DataFrames to sheets, and saving the result.\n\n    Example:\n        &gt;&gt;&gt; wb = Workbook(\"template.xlsx\")\n        &gt;&gt;&gt; wb.sheet(\"Data\").write_df(df, row=5, col=2)\n        &gt;&gt;&gt; wb.save(\"output.xlsx\")\n    \"\"\"\n\n    def __init__(self, path: Union[str, Path]) -&gt; None:\n        \"\"\"\n        Load an existing Excel workbook from disk.\n\n        Args:\n            path: Path to the .xlsx file to load\n\n        Raises:\n            FileNotFoundError: If the file does not exist\n            openpyxl.utils.exceptions.InvalidFileException: If not a valid xlsx\n        \"\"\"\n        self._path = Path(path)\n        if not self._path.exists():\n            raise FileNotFoundError(f\"Workbook not found: {self._path}\")\n\n        self._wb: OpenpyxlWorkbook = openpyxl_load_workbook(\n            self._path,\n            data_only=False,  # Preserve formulas\n        )\n        self._sheets: dict[str, Sheet] = {}\n\n    @property\n    def sheet_names(self) -&gt; list[str]:\n        \"\"\"List of all sheet names in the workbook.\"\"\"\n        return self._wb.sheetnames\n\n    def sheet(self, name: str) -&gt; Sheet:\n        \"\"\"\n        Get a Sheet object for the named worksheet.\n\n        Args:\n            name: The name of the worksheet\n\n        Returns:\n            A Sheet object for the worksheet\n\n        Raises:\n            KeyError: If no sheet with that name exists\n        \"\"\"\n        if name not in self._wb.sheetnames:\n            raise KeyError(f\"Sheet '{name}' not found. Available: {self.sheet_names}\")\n\n        # Cache Sheet objects for reuse\n        if name not in self._sheets:\n            self._sheets[name] = Sheet(self._wb[name], self)\n\n        return self._sheets[name]\n\n    def save(self, path: Union[str, Path]) -&gt; None:\n        \"\"\"\n        Save the workbook to disk.\n\n        Args:\n            path: Destination path for the saved workbook\n        \"\"\"\n        self._wb.save(Path(path))\n\n    def close(self) -&gt; None:\n        \"\"\"Close the workbook and release resources.\"\"\"\n        self._wb.close()\n\n    def __enter__(self) -&gt; Workbook:\n        \"\"\"Context manager entry.\"\"\"\n        return self\n\n    def __exit__(self, exc_type, exc_val, exc_tb) -&gt; None:\n        \"\"\"Context manager exit - closes the workbook.\"\"\"\n        self.close()\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.sheet_names","title":"<code>sheet_names</code>  <code>property</code>","text":"<p>List of all sheet names in the workbook.</p>"},{"location":"reference/api/#xltemplate.Workbook.__init__","title":"<code>__init__(path)</code>","text":"<p>Load an existing Excel workbook from disk.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>Union[str, Path]</code> <p>Path to the .xlsx file to load</p> required <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the file does not exist</p> <code>InvalidFileException</code> <p>If not a valid xlsx</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>def __init__(self, path: Union[str, Path]) -&gt; None:\n    \"\"\"\n    Load an existing Excel workbook from disk.\n\n    Args:\n        path: Path to the .xlsx file to load\n\n    Raises:\n        FileNotFoundError: If the file does not exist\n        openpyxl.utils.exceptions.InvalidFileException: If not a valid xlsx\n    \"\"\"\n    self._path = Path(path)\n    if not self._path.exists():\n        raise FileNotFoundError(f\"Workbook not found: {self._path}\")\n\n    self._wb: OpenpyxlWorkbook = openpyxl_load_workbook(\n        self._path,\n        data_only=False,  # Preserve formulas\n    )\n    self._sheets: dict[str, Sheet] = {}\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.sheet","title":"<code>sheet(name)</code>","text":"<p>Get a Sheet object for the named worksheet.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>The name of the worksheet</p> required <p>Returns:</p> Type Description <code>Sheet</code> <p>A Sheet object for the worksheet</p> <p>Raises:</p> Type Description <code>KeyError</code> <p>If no sheet with that name exists</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>def sheet(self, name: str) -&gt; Sheet:\n    \"\"\"\n    Get a Sheet object for the named worksheet.\n\n    Args:\n        name: The name of the worksheet\n\n    Returns:\n        A Sheet object for the worksheet\n\n    Raises:\n        KeyError: If no sheet with that name exists\n    \"\"\"\n    if name not in self._wb.sheetnames:\n        raise KeyError(f\"Sheet '{name}' not found. Available: {self.sheet_names}\")\n\n    # Cache Sheet objects for reuse\n    if name not in self._sheets:\n        self._sheets[name] = Sheet(self._wb[name], self)\n\n    return self._sheets[name]\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.save","title":"<code>save(path)</code>","text":"<p>Save the workbook to disk.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>Union[str, Path]</code> <p>Destination path for the saved workbook</p> required Source code in <code>xltemplate\\workbook.py</code> <pre><code>def save(self, path: Union[str, Path]) -&gt; None:\n    \"\"\"\n    Save the workbook to disk.\n\n    Args:\n        path: Destination path for the saved workbook\n    \"\"\"\n    self._wb.save(Path(path))\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.close","title":"<code>close()</code>","text":"<p>Close the workbook and release resources.</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>def close(self) -&gt; None:\n    \"\"\"Close the workbook and release resources.\"\"\"\n    self._wb.close()\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.__enter__","title":"<code>__enter__()</code>","text":"<p>Context manager entry.</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>def __enter__(self) -&gt; Workbook:\n    \"\"\"Context manager entry.\"\"\"\n    return self\n</code></pre>"},{"location":"reference/api/#xltemplate.Workbook.__exit__","title":"<code>__exit__(exc_type, exc_val, exc_tb)</code>","text":"<p>Context manager exit - closes the workbook.</p> Source code in <code>xltemplate\\workbook.py</code> <pre><code>def __exit__(self, exc_type, exc_val, exc_tb) -&gt; None:\n    \"\"\"Context manager exit - closes the workbook.\"\"\"\n    self.close()\n</code></pre>"},{"location":"reference/api/#sheet","title":"Sheet","text":""},{"location":"reference/api/#xltemplate.Sheet","title":"<code>xltemplate.Sheet</code>","text":"<p>Represents a worksheet within a Workbook.</p> <p>Provides methods for writing DataFrames and values while preserving existing formatting and formulas.</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>The name of the worksheet</p> Source code in <code>xltemplate\\sheet.py</code> <pre><code>class Sheet:\n    \"\"\"\n    Represents a worksheet within a Workbook.\n\n    Provides methods for writing DataFrames and values while preserving\n    existing formatting and formulas.\n\n    Attributes:\n        name: The name of the worksheet\n    \"\"\"\n\n    def __init__(self, worksheet: Worksheet, workbook: Workbook) -&gt; None:\n        \"\"\"\n        Initialize a Sheet wrapper.\n\n        Args:\n            worksheet: The underlying openpyxl Worksheet object\n            workbook: Reference to the parent Workbook\n        \"\"\"\n        self._ws = worksheet\n        self._wb = workbook\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"The name of this worksheet.\"\"\"\n        return self._ws.title\n\n    def write_df(\n        self,\n        df: Any,\n        row: int,\n        col: int,\n        *,\n        headers: bool = True,\n        preserve_format: bool = True,\n        preserve_formulas: bool = True,\n    ) -&gt; Sheet:\n        \"\"\"\n        Write a DataFrame to the worksheet starting at the specified position.\n\n        Args:\n            df: A Pandas or Polars DataFrame\n            row: Starting row (1-indexed)\n            col: Starting column (1-indexed)\n            headers: Include column headers as the first row (default: True)\n            preserve_format: Keep existing cell formatting (default: True)\n            preserve_formulas: Skip cells containing formulas (default: True)\n\n        Returns:\n            Self for method chaining\n\n        Raises:\n            TypeError: If df is not a supported DataFrame type\n            ValueError: If row or col is less than 1\n        \"\"\"\n        if row &lt; 1 or col &lt; 1:\n            raise ValueError(\"row and col must be &gt;= 1 (1-indexed)\")\n\n        for r_idx, data_row in enumerate(iter_dataframe_rows(df, headers), start=row):\n            for c_idx, value in enumerate(data_row, start=col):\n                self._write_cell(\n                    r_idx, c_idx, value,\n                    preserve_format=preserve_format,\n                    preserve_formulas=preserve_formulas,\n                )\n\n        return self\n\n    def write_value(\n        self,\n        value: Any,\n        row: int,\n        col: int,\n        *,\n        preserve_format: bool = True,\n    ) -&gt; Sheet:\n        \"\"\"\n        Write a single value to a cell.\n\n        Args:\n            value: The value to write\n            row: Row number (1-indexed)\n            col: Column number (1-indexed)\n            preserve_format: Keep existing cell formatting (default: True)\n\n        Returns:\n            Self for method chaining\n\n        Raises:\n            ValueError: If row or col is less than 1\n        \"\"\"\n        if row &lt; 1 or col &lt; 1:\n            raise ValueError(\"row and col must be &gt;= 1 (1-indexed)\")\n\n        self._write_cell(row, col, value, preserve_format=preserve_format)\n        return self\n\n    def _write_cell(\n        self,\n        row: int,\n        col: int,\n        value: Any,\n        *,\n        preserve_format: bool = True,\n        preserve_formulas: bool = False,\n    ) -&gt; None:\n        \"\"\"\n        Internal method to write a value to a cell with optional preservation.\n\n        Args:\n            row: Row number (1-indexed)\n            col: Column number (1-indexed)\n            value: The value to write\n            preserve_format: Keep existing cell formatting\n            preserve_formulas: Skip if cell contains a formula\n        \"\"\"\n        cell = self._ws.cell(row=row, column=col)\n\n        # Skip cells with formulas if preserve_formulas is True\n        if preserve_formulas:\n            current_value = cell.value\n            if isinstance(current_value, str) and current_value.startswith(\"=\"):\n                return\n\n        if preserve_format:\n            # Store the existing style ID before writing\n            existing_style = cell._style\n            cell.value = value\n            # Restore the style after writing\n            cell._style = existing_style\n        else:\n            cell.value = value\n</code></pre>"},{"location":"reference/api/#xltemplate.Sheet.name","title":"<code>name</code>  <code>property</code>","text":"<p>The name of this worksheet.</p>"},{"location":"reference/api/#xltemplate.Sheet.write_df","title":"<code>write_df(df, row, col, *, headers=True, preserve_format=True, preserve_formulas=True)</code>","text":"<p>Write a DataFrame to the worksheet starting at the specified position.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>Any</code> <p>A Pandas or Polars DataFrame</p> required <code>row</code> <code>int</code> <p>Starting row (1-indexed)</p> required <code>col</code> <code>int</code> <p>Starting column (1-indexed)</p> required <code>headers</code> <code>bool</code> <p>Include column headers as the first row (default: True)</p> <code>True</code> <code>preserve_format</code> <code>bool</code> <p>Keep existing cell formatting (default: True)</p> <code>True</code> <code>preserve_formulas</code> <code>bool</code> <p>Skip cells containing formulas (default: True)</p> <code>True</code> <p>Returns:</p> Type Description <code>Sheet</code> <p>Self for method chaining</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>If df is not a supported DataFrame type</p> <code>ValueError</code> <p>If row or col is less than 1</p> Source code in <code>xltemplate\\sheet.py</code> <pre><code>def write_df(\n    self,\n    df: Any,\n    row: int,\n    col: int,\n    *,\n    headers: bool = True,\n    preserve_format: bool = True,\n    preserve_formulas: bool = True,\n) -&gt; Sheet:\n    \"\"\"\n    Write a DataFrame to the worksheet starting at the specified position.\n\n    Args:\n        df: A Pandas or Polars DataFrame\n        row: Starting row (1-indexed)\n        col: Starting column (1-indexed)\n        headers: Include column headers as the first row (default: True)\n        preserve_format: Keep existing cell formatting (default: True)\n        preserve_formulas: Skip cells containing formulas (default: True)\n\n    Returns:\n        Self for method chaining\n\n    Raises:\n        TypeError: If df is not a supported DataFrame type\n        ValueError: If row or col is less than 1\n    \"\"\"\n    if row &lt; 1 or col &lt; 1:\n        raise ValueError(\"row and col must be &gt;= 1 (1-indexed)\")\n\n    for r_idx, data_row in enumerate(iter_dataframe_rows(df, headers), start=row):\n        for c_idx, value in enumerate(data_row, start=col):\n            self._write_cell(\n                r_idx, c_idx, value,\n                preserve_format=preserve_format,\n                preserve_formulas=preserve_formulas,\n            )\n\n    return self\n</code></pre>"},{"location":"reference/api/#xltemplate.Sheet.write_value","title":"<code>write_value(value, row, col, *, preserve_format=True)</code>","text":"<p>Write a single value to a cell.</p> <p>Parameters:</p> Name Type Description Default <code>value</code> <code>Any</code> <p>The value to write</p> required <code>row</code> <code>int</code> <p>Row number (1-indexed)</p> required <code>col</code> <code>int</code> <p>Column number (1-indexed)</p> required <code>preserve_format</code> <code>bool</code> <p>Keep existing cell formatting (default: True)</p> <code>True</code> <p>Returns:</p> Type Description <code>Sheet</code> <p>Self for method chaining</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If row or col is less than 1</p> Source code in <code>xltemplate\\sheet.py</code> <pre><code>def write_value(\n    self,\n    value: Any,\n    row: int,\n    col: int,\n    *,\n    preserve_format: bool = True,\n) -&gt; Sheet:\n    \"\"\"\n    Write a single value to a cell.\n\n    Args:\n        value: The value to write\n        row: Row number (1-indexed)\n        col: Column number (1-indexed)\n        preserve_format: Keep existing cell formatting (default: True)\n\n    Returns:\n        Self for method chaining\n\n    Raises:\n        ValueError: If row or col is less than 1\n    \"\"\"\n    if row &lt; 1 or col &lt; 1:\n        raise ValueError(\"row and col must be &gt;= 1 (1-indexed)\")\n\n    self._write_cell(row, col, value, preserve_format=preserve_format)\n    return self\n</code></pre>"},{"location":"reference/api/#preserving-formulas","title":"Preserving Formulas","text":"<p>By default, <code>write_df()</code> will skip cells containing formulas. This prevents accidental overwriting of calculated fields.</p> <pre><code># Formula at C5 will NOT be overwritten\nwb.sheet(\"Data\").write_df(df, row=1, col=1, preserve_formulas=True)\n\n# Force overwrite formulas\nwb.sheet(\"Data\").write_df(df, row=1, col=1, preserve_formulas=False)\n</code></pre>"},{"location":"reference/api/#preserving-formatting","title":"Preserving Formatting","text":"<p>Cell formatting (fonts, colors, borders, fills) is preserved by default when writing values:</p> <pre><code># Formatting preserved (default)\nwb.sheet(\"Data\").write_value(\"New Text\", row=1, col=1, preserve_format=True)\n\n# Clear formatting\nwb.sheet(\"Data\").write_value(\"New Text\", row=1, col=1, preserve_format=False)\n</code></pre>"},{"location":"tutorials/","title":"Tutorials","text":"<p>Learn how to use xltemplate effectively with these step-by-step guides.</p>"},{"location":"tutorials/#available-tutorials","title":"Available Tutorials","text":""},{"location":"tutorials/#getting-started","title":"Getting Started","text":"<p>Your first xltemplate workflow: create a template, populate it with data, and save the result.</p>"},{"location":"tutorials/#summarizing-dataframes","title":"Summarizing DataFrames","text":"<p>Create a multi-sheet template with conditional formatting and populate it with plotnine DataFrames.</p>"},{"location":"tutorials/#coming-soon","title":"Coming Soon","text":"<ul> <li>Preserving Complex Formatting</li> <li>Working with Named Ranges</li> </ul>"},{"location":"tutorials/01_getting_started/","title":"Getting Started","text":"<p>This tutorial walks you through your first xltemplate workflow.</p>"},{"location":"tutorials/01_getting_started/#prerequisites","title":"Prerequisites","text":"<p>Install xltemplate with DataFrame support:</p> <pre><code>pip install xltemplate[pandas]\n# or\npip install xltemplate[polars]\n</code></pre>"},{"location":"tutorials/01_getting_started/#step-1-create-a-template","title":"Step 1: Create a Template","text":"<p>First, create an Excel template with your headers and formatting. You can use Excel, LibreOffice, or openpyxl directly:</p> <pre><code>from openpyxl import Workbook as OpenpyxlWorkbook\nfrom openpyxl.styles import Font, PatternFill\n\n# Create a template with formatting\nwb = OpenpyxlWorkbook()\nws = wb.active\nws.title = \"Sales Data\"\n\n# Add formatted headers\nheaders = [\"Date\", \"Product\", \"Quantity\", \"Price\", \"Total\"]\nfor col, header in enumerate(headers, start=1):\n    cell = ws.cell(row=1, column=col, value=header)\n    cell.font = Font(bold=True, color=\"FFFFFF\")\n    cell.fill = PatternFill(start_color=\"2E86AB\", fill_type=\"solid\")\n\n# Add a formula in the Total column (row 2 as example)\nws[\"E2\"] = \"=C2*D2\"\n\nwb.save(\"sales_template.xlsx\")\nwb.close()\n</code></pre>"},{"location":"tutorials/01_getting_started/#step-2-populate-the-template","title":"Step 2: Populate the Template","text":"<p>Now use xltemplate to fill in your data:</p> <pre><code>import pandas as pd\nfrom xltemplate import Workbook\n\n# Sample data\ndf = pd.DataFrame({\n    \"Date\": [\"2024-01-15\", \"2024-01-16\", \"2024-01-17\"],\n    \"Product\": [\"Widget A\", \"Widget B\", \"Widget A\"],\n    \"Quantity\": [10, 5, 8],\n    \"Price\": [29.99, 49.99, 29.99],\n})\n\n# Load template and write data\nwith Workbook(\"sales_template.xlsx\") as wb:\n    # Write DataFrame starting at row 2 (below headers), column 1\n    # headers=False since template already has headers\n    wb.sheet(\"Sales Data\").write_df(df, row=2, col=1, headers=False)\n\n    wb.save(\"sales_report.xlsx\")\n</code></pre>"},{"location":"tutorials/01_getting_started/#step-3-verify-the-result","title":"Step 3: Verify the Result","text":"<p>Open <code>sales_report.xlsx</code> and you'll see:</p> <ul> <li>\u2705 Your data in the correct location</li> <li>\u2705 Header formatting preserved (bold, colored)</li> <li>\u2705 Formula in column E calculating totals</li> </ul>"},{"location":"tutorials/01_getting_started/#method-chaining","title":"Method Chaining","text":"<p>Write to multiple locations in a fluent style:</p> <pre><code>with Workbook(\"template.xlsx\") as wb:\n    (wb.sheet(\"Data\")\n       .write_df(main_data, row=5, col=1)\n       .write_value(\"Generated: 2024-01-17\", row=1, col=1))\n\n    wb.save(\"output.xlsx\")\n</code></pre>"},{"location":"tutorials/01_getting_started/#next-steps","title":"Next Steps","text":"<ul> <li>Explore the API Reference for all available options</li> <li>Learn about preserving formulas when writing over cells</li> </ul>"},{"location":"tutorials/02_summarize_dataframes/","title":"Summarizing Multiple DataFrames","text":"<p>This tutorial demonstrates how to create a multi-sheet Excel template with conditional formatting and populate it with multiple DataFrames.</p>"},{"location":"tutorials/02_summarize_dataframes/#prerequisites","title":"Prerequisites","text":"<p>Install xltemplate with plotnine for demo DataFrames:</p> <pre><code>pip install xltemplate[pandas] plotnine\n</code></pre>"},{"location":"tutorials/02_summarize_dataframes/#overview","title":"Overview","text":"<p>We'll create an Excel workbook with:</p> <ul> <li>mtcars \u2014 Motor Trend Car Road Tests (1974)</li> <li>mpg \u2014 Fuel economy data (1999-2008)  </li> <li>diamonds \u2014 Prices of 50,000 diamonds</li> <li>Summary \u2014 Metadata table with row/column counts</li> </ul> <p>Each data sheet will have: - Formatted headers - Conditional formatting (green \u2192 yellow \u2192 red color scale)</p>"},{"location":"tutorials/02_summarize_dataframes/#step-1-create-the-template","title":"Step 1: Create the Template","text":"<p>First, we create a template with openpyxl that includes conditional formatting:</p> <pre><code>from openpyxl import Workbook as OpenpyxlWorkbook\nfrom openpyxl.styles import Font, PatternFill, Alignment\nfrom openpyxl.formatting.rule import ColorScaleRule\nfrom openpyxl.utils import get_column_letter\nfrom plotnine.data import mtcars, mpg, diamonds\n\n# DataFrame metadata\nDATAFRAMES = {\n    \"mtcars\": {\n        \"df\": mtcars,\n        \"description\": \"Motor Trend Car Road Tests (1974)\",\n    },\n    \"mpg\": {\n        \"df\": mpg,\n        \"description\": \"Fuel economy data (1999-2008)\",\n    },\n    \"diamonds\": {\n        \"df\": diamonds,\n        \"description\": \"Prices of 50,000 round cut diamonds\",\n    },\n}\n\n# Create workbook\nwb = OpenpyxlWorkbook()\nwb.remove(wb.active)\n\n# Styles\nheader_font = Font(bold=True, color=\"FFFFFF\")\nheader_fill = PatternFill(start_color=\"2E86AB\", fill_type=\"solid\")\n\n# Create sheets for each DataFrame\nfor sheet_name, meta in DATAFRAMES.items():\n    df = meta[\"df\"]\n    ws = wb.create_sheet(title=sheet_name)\n\n    # Add headers\n    for col_idx, col_name in enumerate(df.columns, start=1):\n        cell = ws.cell(row=1, column=col_idx, value=col_name)\n        cell.font = header_font\n        cell.fill = header_fill\n        ws.column_dimensions[get_column_letter(col_idx)].width = 12\n\n    # Add conditional formatting (color scale)\n    data_end_row = len(df) + 1\n    for col_idx in range(1, len(df.columns) + 1):\n        col_letter = get_column_letter(col_idx)\n        cell_range = f\"{col_letter}2:{col_letter}{data_end_row}\"\n\n        color_scale = ColorScaleRule(\n            start_type=\"min\", start_color=\"63BE7B\",  # Green\n            mid_type=\"percentile\", mid_value=50, mid_color=\"FFEB84\",  # Yellow\n            end_type=\"max\", end_color=\"F8696B\",  # Red\n        )\n        ws.conditional_formatting.add(cell_range, color_scale)\n\nwb.save(\"dataframes_template.xlsx\")\nwb.close()\n</code></pre>"},{"location":"tutorials/02_summarize_dataframes/#step-2-create-the-summary-sheet","title":"Step 2: Create the Summary Sheet","text":"<p>Add a summary sheet with formulas that reference the data sheets:</p> <pre><code># Create Summary sheet\nws_summary = wb.create_sheet(title=\"Summary\")\n\nsummary_headers = [\"Dataset\", \"Description\", \"Rows\", \"Columns\"]\nfor col_idx, header in enumerate(summary_headers, start=1):\n    cell = ws_summary.cell(row=1, column=col_idx, value=header)\n    cell.font = header_font\n    cell.fill = header_fill\n\n# Add formulas\nfor row_idx, (sheet_name, meta) in enumerate(DATAFRAMES.items(), start=2):\n    ws_summary.cell(row=row_idx, column=1, value=sheet_name)\n    ws_summary.cell(row=row_idx, column=2, value=meta[\"description\"])\n    # Formula to count non-empty cells in column A minus header\n    ws_summary.cell(row=row_idx, column=3, value=f\"=COUNTA('{sheet_name}'!A:A)-1\")\n    # Formula to count columns in header row\n    ws_summary.cell(row=row_idx, column=4, value=f\"=COUNTA('{sheet_name}'!1:1)\")\n</code></pre>"},{"location":"tutorials/02_summarize_dataframes/#step-3-populate-with-xltemplate","title":"Step 3: Populate with xltemplate","text":"<p>Now use xltemplate to write the DataFrames while preserving all formatting:</p> <pre><code>from xltemplate import Workbook\n\nwith Workbook(\"dataframes_template.xlsx\") as wb:\n    for sheet_name, meta in DATAFRAMES.items():\n        wb.sheet(sheet_name).write_df(\n            meta[\"df\"], \n            row=2,      # Below headers\n            col=1, \n            headers=False  # Template has headers\n        )\n\n    wb.save(\"dataframes_summary.xlsx\")\n</code></pre>"},{"location":"tutorials/02_summarize_dataframes/#result","title":"Result","text":"<p>Open <code>dataframes_summary.xlsx</code> and you'll see:</p> Sheet Content mtcars 32 rows \u00d7 11 columns with color-scaled values mpg 234 rows \u00d7 11 columns with color-scaled values diamonds 53,940 rows \u00d7 10 columns with color-scaled values Summary Auto-calculated row/column counts via formulas <p>The conditional formatting applies automatically\u2014numeric columns show a gradient from green (low) through yellow to red (high).</p>"},{"location":"tutorials/02_summarize_dataframes/#key-takeaways","title":"Key Takeaways","text":"<ol> <li>Create formatting in the template \u2014 Conditional formatting, styles, and formulas go in the template</li> <li>xltemplate preserves everything \u2014 Writing data doesn't destroy your formatting</li> <li>Formulas auto-calculate \u2014 Summary formulas update when Excel opens the file</li> </ol>"},{"location":"tutorials/02_summarize_dataframes/#next-steps","title":"Next Steps","text":"<ul> <li>Add more complex conditional formatting rules</li> <li>Use named ranges for cleaner formula references</li> <li>Explore the API Reference for all options</li> </ul>"}]}